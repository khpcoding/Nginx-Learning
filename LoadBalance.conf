# Define an upstream group named 'backends' with three backend servers
upstream backends {
    #least_conn;  # Use the least connections algorithm for load balancing
    #ip_hash; # Use the IP hash algorithm for session persistence
    server 127.0.0.1:8080 weight=5;  # First backend server with a weight of 5
    server 127.0.0.1:8081 weight=2;  # Second backend server with a weight of 2
    server 127.0.0.1:8082 weight=1;  # Third backend server with a weight of 1
}

# Define the main server block for load balancing
server {
    server_name 127.0.0.1;  # Server name (hostname or IP address)
    listen 85;  # Listen on port 85

    location / {
        proxy_pass http://backends;  # Proxy requests to the 'backends' upstream group
    }
}

# Define the server block for the first backend
server {
    server_name 127.0.0.1;  # Server name (hostname or IP address)
    listen 8080;  # Listen on port 8080
    root /home/blog/one;  # Root directory for serving files
}

# Define the server block for the second backend
server {
    server_name 127.0.0.1;  # Server name (hostname or IP address)
    listen 8081;  # Listen on port 8081
    root /home/blog/two;  # Root directory for serving files
}

# Define the server block for the third backend
server {
    server_name 127.0.0.1;  # Server name (hostname or IP address)
    listen 8082;  # Listen on port 8082
    root /home/blog/three;  # Root directory for serving files
}
